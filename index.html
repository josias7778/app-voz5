<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>App Voz ‚Äì Paradas e Produ√ß√£o</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:20px;max-width:600px;margin:auto}
    label{display:block;margin-top:12px;font-weight:bold}
    input{width:100%;padding:8px;margin-top:4px;font-size:16px}
    button{margin-top:20px;padding:12px 20px;font-size:18px;cursor:pointer}
    #status{margin-top:15px;font-weight:bold;color:#006600}
    #resumo{margin-top:20px;background:#f3f3f3;padding:12px;border-radius:8px;display:none}
    #menuPosEnvio button{margin-right:10px}
  </style>
</head>
<body>
<audio id="beep" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<div id="loginDiv">
  <h2>Login</h2>
  <label>Usu√°rio:<input id="usuarioLogin" /></label>
  <label>Senha:<input id="senhaLogin" type="password" /></label>
  <button id="loginBtn">Entrar</button>
  <div id="loginStatus"></div>
</div>
<div id="appDiv" style="display:none">
  <h2>Apontamento de Parada (DISP)</h2>
  <p>Cada vez que clicar, o app vai pedir o pr√≥ximo campo. Fale s√≥ o valor.</p>
  <label>Turma:<input id="turma" readonly /></label>
  <label>Linha de Produ√ß√£o:<input id="linha" readonly /></label>
  <label>Data In√≠cio:<input id="dataInicio" readonly /></label>
  <label>Data Final:<input id="dataFinal" readonly /></label>
  <label>Hora In√≠cio:<input id="horaInicio" readonly /></label>
  <label>Hora Final:<input id="horaFinal" readonly /></label>
  <label>Instala√ß√£o:<input id="instalacao" readonly /></label>
  <label>OP:<input id="op" readonly /></label>
  <label>Motivo:<input id="motivo" readonly /></label>
  <label>Origem:<input id="origem" readonly /></label>
  <label>Classifica√ß√£o:<input id="classificacao" readonly /></label>
  <button id="startBtn">Come√ßar preenchimento</button>
  <button id="repetirBtn" style="display:none">üîÅ Repetir campo</button>
  <button id="cancelarBtn" style="display:none">üßπ Cancelar e reiniciar</button>
  <button id="enviarBtn" style="display:none">Enviar dados</button>
  <div id="status"></div>
  <div id="resumo"></div>
  <div id="menuPosEnvio" style="display:none">
    <button id="novaParadaBtn">‚ûï Nova parada</button>
    <button id="apontarProducaoBtn">üì¶ Apontar produ√ß√£o</button>
    <button id="encerrarBtn">‚èπÔ∏è Encerrar</button>
  </div>
</div>
<script>
function converterTurma(resposta) {
  const termo = resposta.trim().toLowerCase().replace("turma", "").replace("zero", "").trim();
  const mapa = {
    "1": "Turma 1 - 6 x 2",
    "um": "Turma 1 - 6 x 2",
    "2": "Turma 2 - 6 x 2",
    "dois": "Turma 2 - 6 x 2",
    "3": "Turma 3 - 6 x 2",
    "tres": "Turma 3 - 6 x 2",
    "tr√™s": "Turma 3 - 6 x 2",
    "4": "Turma 4 - 6 x 2",
    "quatro": "Turma 4 - 6 x 2"
  };
  const turma = mapa[termo];
  if (!turma) {
    alert("Turma n√£o reconhecida. Diga: um, dois, tr√™s ou quatro.");
    return null;
  }
  return turma;
}

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();
recognition.lang = 'pt-BR';
recognition.interimResults = false;
recognition.maxAlternatives = 1;

const campos = ["turma", "linha", "dataInicio", "dataFinal", "horaInicio", "horaFinal", "instalacao", "op", "motivo", "origem", "classificacao"];
let campoAtual = 0;
const startBtn = document.getElementById('startBtn');
const statusDiv = document.getElementById('status');

startBtn.addEventListener('click', () => {
  recognition.start();
});

recognition.onresult = (event) => {
  let resposta = event.results[0][0].transcript.trim();
  const campoId = campos[campoAtual];
  if (campoId === 'turma') {
    const convertido = converterTurma(resposta);
    if (convertido) {
      document.getElementById(campoId).value = convertido;
    }
  } else {
    document.getElementById(campoId).value = resposta;
  }
  campoAtual++;
  if (campoAtual >= campos.length) {
    statusDiv.textContent = '‚úÖ Todos os campos preenchidos!';
    startBtn.disabled = true;
  } else {
    statusDiv.textContent = `Campo preenchido. Agora fale: ${campos[campoAtual]}`;
  }
};

recognition.onerror = (event) => {
  statusDiv.textContent = 'Erro no reconhecimento de voz. Tente novamente.';
};
</script>
</body>
</html>
